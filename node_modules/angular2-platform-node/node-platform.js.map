{"version":3,"file":"node-platform.js","sourceRoot":"","sources":["../../../../modules/platform-node/node-platform.ts"],"names":[],"mappings":"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","sourcesContent":["import { getDOM } from './get-dom';\n\nimport {\n  DOCUMENT,\n  EVENT_MANAGER_PLUGINS,\n  AnimationDriver,\n  EventManager,\n  HAMMER_GESTURE_CONFIG,\n  HammerGestureConfig,\n} from '@angular/platform-browser';\n\nimport {\n  BROWSER_SANITIZATION_PROVIDERS,\n  DomEventsPlugin,\n  KeyEventsPlugin,\n  DomRootRenderer,\n  SharedStylesHost,\n  HammerGesturesPlugin,\n  DomSharedStylesHost,\n} from './__private_imports__';\n\nimport {\n  ErrorHandler,\n  RootRenderer,\n  Testability,\n  ApplicationModule,\n  PLATFORM_INITIALIZER,\n  APP_ID,\n  Injector,\n  createPlatformFactory,\n\n  NgModule,\n  ModuleWithProviders,\n  Optional,\n  SkipSelf,\n  Injectable,\n  Inject,\n  ComponentRef,\n  ApplicationRef,\n  PlatformRef,\n  NgModuleRef,\n  NgZone,\n  CompilerFactory,\n  TestabilityRegistry,\n} from '@angular/core';\n\nimport { CommonModule, PlatformLocation, APP_BASE_HREF } from '@angular/common';\nimport { platformCoreDynamic } from '@angular/compiler';\n\n// TODO(gdi2290): allow removal of modules that are not used for AoT\nimport { Jsonp, Http } from '@angular/http';\nimport { getInlineCode } from 'preboot';\n\n\nimport { NodePlatformLocation } from './node-location';\nimport { parseFragment, parseDocument, serializeDocument } from './node-document';\nimport { NodeDomRootRenderer } from './node-renderer';\nimport { NodeSharedStylesHost } from './node-shared-styles-host';\nimport { Parse5DomAdapter } from './parse5-adapter';\n\nimport {\n  ORIGIN_URL,\n  REQUEST_URL,\n\n  createUrlProviders,\n} from './tokens';\n\n// @internal\n\nexport function _errorHandler(): ErrorHandler {\n  return new ErrorHandler();\n}\n\ndeclare var Zone: any;\n\n// @internal\nconst _documentDeps = [ NodeSharedStylesHost, NgZone ];\nexport function _document(domSharedStylesHost: NodeSharedStylesHost, _zone: any): any {\n  let document: any = Zone.current.get('document');\n  if (!document) {\n    throw new Error('Please provide a document in the universal config');\n  }\n  if (typeof document === 'string') {\n    document = parseDocument(document);\n  }\n  domSharedStylesHost.addHost(document.head);\n  return document;\n}\n\n// @internal\nexport function _resolveDefaultAnimationDriver(): AnimationDriver {\n  if (getDOM().supportsWebAnimation()) {\n    return AnimationDriver.NOOP;\n  }\n  return AnimationDriver.NOOP;\n}\n\n// Hold Reference\n// @internal\nexport var __PLATFORM_REF: PlatformRef = null;\nexport function removePlatformRef() {\n  __PLATFORM_REF = null;\n}\nexport function getPlatformRef(): PlatformRef {\n  return __PLATFORM_REF;\n}\nexport function setPlatformRef(platformRef) {\n  __PLATFORM_REF = platformRef;\n}\n// End platform Reference\n\n// @internal\nfunction s4() {\n  return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n}\n\n              /*implements PlatformRef*/\nexport class NodePlatform  {\n  static _noop = () => {};\n  static _cache = new WeakMap<any, any>();\n  get platformRef() {\n    return this._platformRef;\n  }\n  constructor(private _platformRef: PlatformRef) {\n  }\n  cacheModuleFactory<T>(moduleType, compilerOptions?: any): Promise<NgModuleRef<T>> {\n    if (NodePlatform._cache.has(moduleType)) {\n      return Promise.resolve(NodePlatform._cache.get(moduleType));\n    }\n    const compilerFactory: CompilerFactory = this._platformRef.injector.get(CompilerFactory);\n    var compiler;\n    if (compilerOptions) {\n      compiler = compilerFactory.createCompiler(\n      compilerOptions instanceof Array ? compilerOptions : [compilerOptions]);\n    } else {\n      compiler = compilerFactory.createCompiler();\n    }\n    return compiler.compileModuleAsync(moduleType)\n        .then((moduleFactory) => {\n          NodePlatform._cache.set(moduleType, moduleFactory);\n          return moduleFactory;\n        });\n  }\n\n  // TODO(gdi2290): refactor into bootloader\n  serializeModule<T>(ModuleType: any, config: any = {}): Promise<T> {\n    if (config && !config.id) { config.id = s4(); }\n    config.time && console.time('id: ' + config.id + ' bootstrapModule: ');\n    config.time && console.time('id: ' + config.id + ' ngApp: ');\n    return (config.compilerOptions ?\n      this.bootstrapModule<T>(ModuleType, config.compilerOptions)\n      :\n      this.bootstrapModule<T>(ModuleType)\n    )\n      .then((moduleRef: NgModuleRef<T>) => {\n        config.time && console.timeEnd('id: ' + config.id + ' bootstrapModule: ');\n        return this.serialize<T>(moduleRef, config);\n      })\n      .then(html => {\n        config.time && console.timeEnd('id: ' + config.id + ' ngApp: ');\n        return html;\n      })\n      .catch(e => {\n        throw e;\n      });\n\n  }\n  // TODO(gdi2290): refactor into bootloader\n  serializeModuleFactory<T>(ModuleType: any, config: any = {}): Promise<T> | T {\n    if (config && !config.id) { config.id = s4(); }\n    config.time && console.time('id: ' + config.id + ' bootstrapModuleFactory: ');\n    config.time && console.time('id: ' + config.id + ' ngApp: ');\n    return this.bootstrapModuleFactory<T>(ModuleType)\n      .then((moduleRef: NgModuleRef<T>) => {\n        config.time && console.timeEnd('id: ' + config.id + ' bootstrapModuleFactory: ');\n        return this.serialize<T>(moduleRef, config);\n      })\n      .then(html => {\n        config.time && console.timeEnd('id: ' + config.id + ' ngApp: ');\n        return html;\n      })\n      .catch(e => {\n        throw e;\n      });\n  }\n\n  // TODO(gdi2290): refactor into bootloader\n  serialize<T>(moduleRef: NgModuleRef<T>, config: any = {}): Promise<T> {\n    var cancelHandler = () => false;\n    if (config && ('cancelHandler' in config)) {\n      cancelHandler = config.cancelHandler;\n    }\n    // TODO(gdi2290): make stateless. allow for many instances of modules\n    // TODO(gdi2290): refactor to ZoneLocalStore\n    var _map = new Map<any, any>();\n    var _store = {\n      set(key, value, defaultValue?: any) {\n        _map.set(key, (value !== undefined) ? value : defaultValue);\n      },\n      get(key, defaultValue?: any) {\n        return _map.has(key) ? _map.get(key) : defaultValue;\n      },\n      clear() {\n        _map.clear();\n        _store = null;\n        _map = null;\n      }\n    };\n\n    function errorHandler(_err, store, modRef, _currentIndex, _currentArray) {\n      var document = '';\n      try {\n        document = store.get('DOCUMENT');\n        if (typeof document !== 'string') {\n          document = Zone.current.get('document');\n        }\n        if (typeof document !== 'string') {\n          document = Zone.current.get('DOCUMENT');\n        }\n        let appRef = store.get('ApplicationRef');\n        if (appRef && appRef.ngOnDestroy) {\n          appRef.ngOnDestroy();\n        }\n        if (modRef && modRef.destroy) {\n          modRef.destroy();\n        }\n        _store && _store.clear();\n      } catch (e) {}\n      return document;\n    }\n\n    return asyncPromiseSeries(_store, moduleRef, errorHandler, cancelHandler, config,  [\n      // create di store\n      function createDiStore(store: any, moduleRef: NgModuleRef<T>) {\n        let modInjector = moduleRef.injector;\n        let instance: any = moduleRef.instance;\n        // lifecycle hooks\n        store.set('universalOnInit', instance.universalOnInit, NodePlatform._noop);\n        store.set('universalDoCheck', instance.universalDoCheck, NodePlatform._noop);\n        store.set('universalOnStable', instance.universalOnStable, NodePlatform._noop);\n        store.set('universalDoDehydrate', instance.universalDoDehydrate, NodePlatform._noop);\n        store.set('universalAfterDehydrate', instance.universalAfterDehydrate, NodePlatform._noop);\n        store.set('universalOnRendered', instance.universalOnRendered, NodePlatform._noop);\n        // global config\n        store.set('ApplicationRef', modInjector.get(ApplicationRef));\n        store.set('NgZone', modInjector.get(NgZone));\n        store.set('preboot', config.preboot, false);\n        store.set('APP_ID', modInjector.get(APP_ID, null));\n        store.set('NODE_APP_ID', s4());\n        store.set('DOCUMENT', modInjector.get(DOCUMENT));\n        store.set('DOM', getDOM());\n        store.set('UNIVERSAL_CACHE', {});\n        return moduleRef;\n      },\n      // Check Stable\n      function checkStable(store: any, moduleRef: NgModuleRef<T>) {\n        config.time && console.time('id: ' + config.id + ' stable: ');\n        let universalDoCheck = store.get('universalDoCheck');\n        let universalOnInit = store.get('universalOnInit');\n        let universalOnStable = store.get('universalOnStable');\n        let rootNgZone: NgZone = store.get('NgZone');\n        let appRef: ApplicationRef = store.get('ApplicationRef');\n        let components = appRef.components;\n\n        universalOnInit(moduleRef);\n\n        // lifecycle hooks\n        function outsideNg(compRef, ngZone, http, jsonp) {\n          function checkStable(done, ref) {\n            ngZone.runOutsideAngular(() => {\n              setTimeout(function stable() {\n                if (cancelHandler()) { return done(ref); }\n                // hot code path\n                if (ngZone.hasPendingMicrotasks === true) { return checkStable(done, ref); }\n                if (ngZone.hasPendingMacrotasks === true) { return checkStable(done, ref); }\n                if (http && http._async > 0) { return checkStable(done, ref); }\n                if (jsonp && jsonp._async > 0) { return checkStable(done, ref); }\n                if (ngZone.isStable === true) {\n                  let isStable = universalDoCheck(ref, ngZone);\n                  if (universalDoCheck !== NodePlatform._noop) {\n                    if (typeof isStable !== 'boolean') {\n                      console.warn('\\nWARNING: universalDoCheck must return a boolean value of either true or false\\n');\n                    } else if (isStable !== true) {\n                      return checkStable(done, ref);\n                    }\n                  }\n                }\n                if (ngZone.isStable === true) { return done(ref); }\n                return checkStable(done, ref);\n              }, 0);\n            });\n          }\n          return ngZone.runOutsideAngular(() => {\n            return new Promise(function (resolve) {\n              checkStable(resolve, compRef);\n            }); // promise\n          });\n        }\n\n        // check if all components are stable\n\n        let stableComponents = components.map(compRef => {\n          let cmpInjector = compRef.injector;\n          let ngZone: NgZone = cmpInjector.get(NgZone);\n          // TODO(gdi2290): remove when zone.js tracks http and https\n          let http = cmpInjector.get(Http, null);\n          let jsonp = cmpInjector.get(Jsonp, null);\n          return rootNgZone.runOutsideAngular(outsideNg.bind(null, compRef, ngZone, http, jsonp));\n        });\n\n        return rootNgZone.runOutsideAngular(() => {\n          return Promise.all<Promise<ComponentRef<any>>>(stableComponents);\n        })\n          .then(() => {\n            config.time && console.timeEnd('id: ' + config.id + ' stable: ');\n            universalOnStable(moduleRef)\n            return moduleRef;\n          });\n      },\n      // Inject preboot\n      function injectPreboot(store: any, moduleRef: NgModuleRef<T>) {\n        let preboot = store.get('preboot');\n        if (typeof preboot === 'boolean') {\n          if (!preboot) {\n            return moduleRef;\n          } else {\n            preboot = {};\n          }\n        }\n        config.time && console.time('id: ' + config.id + ' preboot: ');\n        // parseFragment used\n        // getInlineCode used\n        let DOM = store.get('DOM');\n        let DOCUMENT = store.get('DOCUMENT');\n        let appRef: ApplicationRef = store.get('ApplicationRef');\n        let selectorsList = (<any>moduleRef).bootstrapFactories.map((factory) => factory.selector);\n        let bodyList = DOCUMENT.body.children.filter(el => Boolean(el.tagName)).map(el => el.tagName.toLowerCase()).join(',');\n        let components = appRef.components;\n        let prebootCode = null;\n        // TODO(gdi2290): hide cache in (ngPreboot|UniversalPreboot)\n        let prebootConfig = null;\n        let key = (typeof preboot === 'object') && preboot || null;\n        let prebootEl = null;\n        let el = null;\n        let lastRef = null;\n        try {\n          if (key && NodePlatform._cache.has(key)) {\n            prebootEl = NodePlatform._cache.get(key).prebootEl;\n            // prebootCode = NodePlatform._cache.get(key);\n          } else if (key && !prebootEl) {\n            try {\n              prebootConfig = JSON.parse(key);\n            } catch (e) {\n              prebootConfig = preboot;\n            }\n            if (!prebootConfig.appRoot) {\n              // TODO(gdi2290): missing public NgModuleInjector type\n              prebootConfig.appRoot = selectorsList;\n            }\n            if (!selectorsList) {\n              selectorsList = (<any>moduleRef).bootstrapFactories.map((factory) => factory.selector);\n            }\n            config.time && console.time('id: ' + config.id + ' preboot insert dom: ');\n            prebootCode = parseFragment('' +\n              '<script>\\n' +\n              ' ' + getInlineCode(prebootConfig) +\n              '</script>' +\n            '');\n            prebootEl = DOM.createElement('div');\n            DOM.appendChild(prebootEl, prebootCode.childNodes[0]);\n            NodePlatform._cache.set(key, {prebootCode, prebootEl});\n            config.time && console.timeEnd('id: ' + config.id + ' preboot insert dom: ');\n          }\n\n          lastRef = {cmp: null, strIndex: -1, index: -1};\n          selectorsList.forEach((select, i) => {\n            let lastValue = bodyList.indexOf(select);\n             if (lastValue >= lastRef.strIndex) {\n               lastRef.strIndex = lastValue;\n               lastRef.cmp = components[i];\n             }\n          });\n          el = lastRef.cmp.location.nativeElement;\n          lastRef = null;\n          DOM.insertAfter(el, prebootEl);\n          // let script = parseFragment(prebootCode);\n        } catch (e) {\n          console.log(e);\n          // if there's an error don't inject preboot\n          config.time && console.timeEnd('id: ' + config.id + ' preboot: ');\n          return moduleRef;\n        }\n\n        config.time && console.timeEnd('id: ' + config.id + ' preboot: ');\n        return moduleRef;\n      },\n      // Dehydrate Cache\n      function dehydrateCache(store: any, moduleRef: NgModuleRef<T>) {\n        config.time && console.time('id: ' + config.id + ' universal cache: ');\n        let appId = store.get('NODE_APP_ID', null);\n        let UNIVERSAL_CACHE = store.get('UNIVERSAL_CACHE');\n        let universalDoDehydrate = store.get('universalDoDehydrate');\n        let cache = {};\n\n        UNIVERSAL_CACHE['APP_ID'] = appId;\n        Object.assign(cache, UNIVERSAL_CACHE);\n        universalDoDehydrate(cache);\n        Object.assign(UNIVERSAL_CACHE, cache);\n        cache = null;\n\n        config.time && console.timeEnd('id: ' + config.id + ' universal cache: ');\n        return moduleRef;\n      },\n      // Inject Cache in Document\n      function injectCacheInDocument(store: any, moduleRef: NgModuleRef<T>) {\n        config.time && console.time('id: ' + config.id + ' dehydrate: ');\n        // parseFragment used\n        let universalAfterDehydrate = store.get('universalAfterDehydrate');\n        let DOM = store.get('DOM');\n        let UNIVERSAL_CACHE = store.get('UNIVERSAL_CACHE');\n        let document = store.get('DOCUMENT');\n        let script = null;\n        let el = null;\n\n        // TODO(gdi2290): move and find a better way to inject script\n        try {\n          config.time && console.time('id: ' + config.id + ' dehydrate insert dom: ');\n          el = DOM.createElement('universal-script');\n\n          script = parseFragment('' +\n          '<script>\\n' +\n          ' try {' +\n            'window.UNIVERSAL_CACHE = (' + JSON.stringify(UNIVERSAL_CACHE) + ') || {};' +\n          '} catch(e) {' +\n          '  console.warn(\"Angular Universal: There was a problem parsing data from the server\")' +\n          '}\\n' +\n          '</script>' +\n          '');\n          DOM.appendChild(el, script.childNodes[0]);\n          DOM.appendChild(document.body, el);\n          el = null;\n\n          universalAfterDehydrate();\n          config.time && console.timeEnd('id: ' + config.id + ' dehydrate insert dom: ');\n\n        } catch (e) {\n          config.time && console.timeEnd('id: ' + config.id + ' dehydrate: ');\n          return moduleRef;\n        }\n        config.time && console.timeEnd('id: ' + config.id + ' dehydrate: ');\n        return moduleRef;\n      },\n      // Destroy\n      function destroyAppAndSerializeDocument(store: any, moduleRef: NgModuleRef<T>) {\n        config.time && console.time('id: ' + config.id + ' serialize: ');\n        // serializeDocument used\n        let universalOnRendered = store.get('universalOnRendered');\n        let document = store.get('DOCUMENT');\n        let appId = store.get('NODE_APP_ID');\n        let appRef = store.get('ApplicationRef');\n        let html = null;\n        let destroyApp = null;\n        let destroyModule = null;\n\n        html = serializeDocument(document).replace(/%cmp%/g, appId);\n        universalOnRendered(html);\n\n        document = null;\n        store.clear();\n        destroyApp = () => {\n          appRef.ngOnDestroy();\n          appRef = null;\n          destroyApp = null;\n        };\n        destroyModule = () => {\n          moduleRef.destroy();\n          moduleRef = null;\n          destroyModule = null;\n        };\n        if (config.asyncDestroy) {\n          setTimeout(() => destroyApp() && setTimeout(destroyModule, 1), 1);\n        } else {\n          destroyApp() && destroyModule();\n        }\n\n        config.time && console.timeEnd('id: ' + config.id + ' serialize: ');\n        // html = html.replace(new RegExp(_appId, 'gi'), appId);\n\n        return html;\n      },\n\n    ]); // end asyncPromiseSeries\n  }\n\n\n\n\n\n  // PlatformRef api\n  get injector(): Injector {\n    return this.platformRef.injector;\n  }\n  bootstrapModule<T>(moduleType, compilerOptions?: any): Promise<NgModuleRef<T>> {\n    if (NodePlatform._cache.has(moduleType)) {\n      return this.platformRef.bootstrapModuleFactory(NodePlatform._cache.get(moduleType));\n    }\n    const compilerFactory: CompilerFactory = this._platformRef.injector.get(CompilerFactory);\n    var compiler;\n    if (compilerOptions) {\n      compiler = compilerFactory.createCompiler(\n      compilerOptions instanceof Array ? compilerOptions : [compilerOptions]);\n    } else {\n      compiler = compilerFactory.createCompiler();\n    }\n    return compiler.compileModuleAsync(moduleType)\n        .then((moduleFactory) => {\n          NodePlatform._cache.set(moduleType, moduleFactory);\n          return this.platformRef.bootstrapModuleFactory(moduleFactory);\n        });\n  }\n  bootstrapModuleFactory<T>(moduleFactory): Promise<NgModuleRef<T>> {\n    return this.platformRef.bootstrapModuleFactory(moduleFactory);\n  }\n\n  /**\n   * @deprecated\n   */\n  get disposed() { return this.platformRef.destroyed; }\n  get destroyed() { return this.platformRef.destroyed; }\n\n  destroy() { return this.platformRef.destroy(); }\n\n  /**\n   * @deprecated\n   */\n  dispose(): void { return this.destroy(); }\n  /**\n   * @deprecated\n   */\n  registerDisposeListener(dispose: () => void): void {\n    return this.platformRef.onDestroy(dispose);\n  }\n  onDestroy(callback: () => void): void {\n    this._platformRef = null;\n    return this.platformRef.onDestroy(callback);\n  }\n  // end PlatformRef api\n\n}\n\n/*\n * Ensure async resolve of promises that resolve in series. This is mostly to prevent blocking\n * the event loop and better management of refernces in task. This also allows for ZoneLocalStore.\n * We can also introduce sagas or serverless\n */\nfunction asyncPromiseSeries(store, modRef, errorHandler, cancelHandler, config, middleware, _timer = 1) {\n  let errorCalled = false;\n  config.time && console.time('id: ' + config.id + ' asyncPromiseSeries: ');\n  return middleware.reduce(function reduceAsyncPromiseSeries (promise, cb, currentIndex, currentArray) {\n    // skip the rest of the promise middleware\n    if (errorCalled || cancelHandler()) { return promise; }\n    return promise.then(function reduceAsyncPromiseSeriesChain (ref) {\n      // skip the rest of the promise middleware\n      if (errorCalled || cancelHandler()) { return ref; }\n      return new Promise(function reduceAsyncPromiseSeriesPromiseChain(resolve, reject) {\n        setTimeout(() => {\n          if (errorCalled || cancelHandler()) { return resolve(ref); }\n          try {\n            resolve(cb(store, ref));\n          } catch (e) {\n            reject(e);\n          }\n        }, 0);\n      });\n    }).catch(err => {\n      errorCalled = true;\n      return errorHandler(err, store, modRef, currentIndex, currentArray);\n    });\n  }, Promise.resolve(modRef)).then((val) => {\n    config.time && console.timeEnd('id: ' + config.id + ' asyncPromiseSeries: ');\n    if (cancelHandler()) {\n      return errorHandler(null, store, modRef, null, null);\n    }\n    return val;\n  });\n}\n\nexport interface EventManagerPlugin {\n  manager: EventManager | NodeEventManager;\n  supports(eventName: string): boolean;\n  addEventListener(element: any/*HTMLElement*/, eventName: string, handler: Function): any;\n  addGlobalEventListener(element: string, eventName: string, handler: Function): any;\n}\n\n// TODO(gdi2290): refactor into a new file\n\nexport class NodeEventManager {\n  private _plugins: EventManagerPlugin[];\n\n  constructor(\n     plugins: EventManagerPlugin[],\n     private _document: any,\n    private _zone: NgZone) {\n    plugins.forEach(p => p.manager = this);\n    this._plugins = plugins.slice().reverse();\n  }\n  getWindow() { return this._document._window; }\n  getDocument() { return this._document; }\n  getZone(): NgZone { return this._zone; }\n\n  addEventListener(element: any /*HTMLElement*/, eventName: string, handler: Function): Function {\n    var plugin = this._findPluginFor(eventName);\n    return plugin.addEventListener(element, eventName, handler);\n  }\n\n  addGlobalEventListener(target: string, eventName: string, handler: Function): Function {\n    var plugin = this._findPluginFor(eventName);\n    return plugin.addGlobalEventListener(target, eventName, handler);\n  }\n\n\n  /** @internal */\n  _findPluginFor(eventName: string): EventManagerPlugin {\n    var plugins = this._plugins;\n    for (var i = 0; i < plugins.length; i++) {\n      var plugin = plugins[i];\n      if (plugin.supports(eventName)) {\n        return plugin;\n      }\n    }\n    throw new Error(`No event manager plugin found for event ${eventName}`);\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: ({type: any, decorators?: DecoratorInvocation[]}|null)[] = [\n{type: Array, decorators: [{ type: Inject, args: [EVENT_MANAGER_PLUGINS, ] }, ]},\n{type: undefined, decorators: [{ type: Inject, args: [DOCUMENT, ] }, ]},\n{type: NgZone, },\n];\n}\n\n// TODO(gdi2290): refactor into a new file\n\nexport class NodeDomEventsPlugin {\n  manager: NodeEventManager;\n  // This plugin should come last in the list of plugins, because it accepts all\n  // events.\n  supports(_eventName: string): boolean { return true; }\n\n  addEventListener(element: any/*HTMLElement*/, eventName: string, handler: Function): Function {\n    var zone = this.manager.getZone();\n    var outsideHandler = (event: any) => zone.runGuarded(() => handler(event));\n    return this.manager.getZone().runOutsideAngular(() => {\n      return getDOM().onAndCancel(element, eventName, outsideHandler);\n    });\n  }\n\n  addGlobalEventListener(target: string, eventName: string, handler: Function): Function {\n    // we need to ensure that events are created in the fake document created for the current app\n    var document = this.manager.getDocument();\n    var zone = this.manager.getZone();\n    var element; // = getDOM().getGlobalEventTargetWithDocument(target, window, document, document.body);\n    switch (target) {\n      case 'window':\n        element = document._window;\n        break;\n      case 'document':\n        element = document;\n        break;\n      case 'body':\n        element = document.body;\n        break;\n    }\n    var outsideHandler = (event: any) => zone.runGuarded(() => handler(event));\n    return this.manager.getZone().runOutsideAngular(() => {\n      return getDOM().onAndCancel(element, eventName, outsideHandler);\n    });\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: ({type: any, decorators?: DecoratorInvocation[]}|null)[] = [\n];\n}\n\n\nexport function _APP_BASE_HREF(_zone) {\n  return Zone.current.get('baseUrl');\n}\n\nexport function _REQUEST_URL(_zone) {\n  return Zone.current.get('requestUrl');\n}\n\nexport function _ORIGIN_URL(_zone) {\n  return Zone.current.get('originUrl');\n}\n\nexport class MockTestabilityRegistry extends TestabilityRegistry {\n  registerApplication() {\n    return null;\n  }\n}\n\n\n\nexport class NodeModule {\n  static forRoot(document: string, config: any = {}): ModuleWithProviders {\n    var _config = Object.assign({}, { document }, config);\n    return NodeModule.withConfig(_config);\n  }\n  static withConfig (config: any = {}): ModuleWithProviders {\n    let providers = createUrlProviders(config);\n    return {\n      ngModule: NodeModule,\n      providers: [\n        ...providers,\n      ]\n    };\n  }\n  constructor(  parentModule: NodeModule) {\n    if (parentModule) {\n      throw new Error(`NodeModule has already been loaded.`);\n    }\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: NgModule, args: [{\n  providers: [\n    // default config value\n    // normally in platform provides but there is url state in NodePlatformLocation\n    { provide: PlatformLocation, useClass: NodePlatformLocation },\n\n    BROWSER_SANITIZATION_PROVIDERS,\n\n    { provide: ErrorHandler, useFactory: _errorHandler, deps: [] },\n\n    { provide: DOCUMENT, useFactory: _document, deps: _documentDeps },\n\n    NodeDomEventsPlugin,\n    { provide: DomEventsPlugin, useExisting: NodeDomEventsPlugin, multi: true },\n    { provide: EVENT_MANAGER_PLUGINS, useExisting: NodeDomEventsPlugin, multi: true },\n    { provide: EVENT_MANAGER_PLUGINS, useClass: KeyEventsPlugin, multi: true },\n    { provide: EVENT_MANAGER_PLUGINS, useClass: HammerGesturesPlugin, multi: true },\n    { provide: HAMMER_GESTURE_CONFIG, useClass: HammerGestureConfig },\n\n    NodeEventManager,\n    { provide: EventManager, useExisting: NodeEventManager },\n\n\n    { provide: AnimationDriver, useFactory: _resolveDefaultAnimationDriver, deps: [] },\n    Testability,\n    // TODO(gdi2290): provide concurrent NodeDebugDomRender\n    // ELEMENT_PROBE_PROVIDERS,\n\n    NodeDomRootRenderer,\n    { provide: DomRootRenderer, useExisting: NodeDomRootRenderer },\n    { provide: RootRenderer, useExisting: DomRootRenderer },\n\n    NodeSharedStylesHost,\n    { provide: SharedStylesHost, useExisting: NodeSharedStylesHost },\n    { provide: DomSharedStylesHost, useExisting: NodeSharedStylesHost },\n\n    { provide: APP_BASE_HREF, useFactory: _APP_BASE_HREF, deps: [ NgZone ] },\n    { provide: REQUEST_URL, useFactory: _REQUEST_URL, deps: [ NgZone ] },\n    { provide: ORIGIN_URL, useFactory: _ORIGIN_URL, deps: [ NgZone ] },\n\n    { provide: APP_ID, useValue: '%cmp%' },\n    { provide: TestabilityRegistry, useClass: MockTestabilityRegistry }\n  ],\n  exports: [  CommonModule, ApplicationModule  ]\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: ({type: any, decorators?: DecoratorInvocation[]}|null)[] = [\n{type: NodeModule, decorators: [{ type: Optional }, { type: SkipSelf }, ]},\n];\n}\n\n// @internal\nfunction initParse5Adapter() {\n  Parse5DomAdapter.makeCurrent();\n  // wtfInit();\n}\n\n\nexport const INTERNAL_NODE_PLATFORM_PROVIDERS: Array<any /*Type | Provider | any[]*/> = [\n  { provide: PLATFORM_INITIALIZER, useValue: initParse5Adapter, multi: true },\n  // Move out of platform because NodePlatformLocation holds state\n  // { provide: PlatformLocation, useClass: NodePlatformLocation },\n];\n\n\n/**\n * The node platform that supports the runtime compiler.\n *\n * @experimental\n */\nexport const platformNodeDynamic = (extraProviders?: any[], platform?: any) => {\n  if (!platform) {\n    if (!getPlatformRef()) {\n      platform = createPlatformFactory(platformCoreDynamic, 'nodeDynamic', INTERNAL_NODE_PLATFORM_PROVIDERS)(extraProviders);\n      setPlatformRef(platform);\n    } else {\n      platform = getPlatformRef();\n    }\n  }\n  return new NodePlatform(platform);\n};\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}